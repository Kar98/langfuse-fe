<!DOCTYPE html>
<html>
  <head>
    <title>Langfuse Data</title>
    <script src="echarts.min.js"></script>
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <style>
      body {
        margin: 0;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
      }
    </style>
  </head>
  <body>
    <div id="main" style="width: 100%; height: 85vh; overflow: hidden"></div>
    <script src="login.js"></script>
    <script>
      (async function () {
        var chartDom = document.getElementById("main");
        var myChart = echarts.init(chartDom);
        var option;

        const auth = login();
        console.log(auth);

        const res = await fetch(
          "http://localhost:3000/api/public/metrics?query={%0A%20%20%22view%22%3A%20%22traces%22%2C%0A%20%20%22metrics%22%3A%20[{%22measure%22%3A%20%22count%22%2C%20%22aggregation%22%3A%20%22count%22}]%2C%0A%20%20%22dimensions%22%3A%20[{%22field%22%3A%20%22name%22}]%2C%0A%20%20%22filters%22%3A%20[]%2C%0A%20%20%22fromTimestamp%22%3A%20%222025-12-01T00%3A00%3A00Z%22%2C%0A%20%20%22toTimestamp%22%3A%20%222025-12-20T00%3A00%3A00Z%22%0A}",
          {
            method: "GET",
            headers: {
              Authorization: auth,
            },
          }
        );
        if (!res.ok) {
          console.error("failed to get localhost data");
          return;
        }
        console.log("hit localhost");

        option = {
          xAxis: {
            type: "category",
            data: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          },
          yAxis: {
            type: "value",
          },
          series: [
            {
              data: [150, 230, 224, 218, 135, 147, 260],
              type: "line",
            },
          ],
        };

        option && myChart.setOption(option);
      })();
    </script>
  </body>
</html>
